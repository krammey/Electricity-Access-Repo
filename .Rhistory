library(shiny)
library(shinydashboard)
library(ggplot2)
library(ggmap)
library(maps)
# Load world map and fix virgin islands labels
worldmap <- map_data(map="world")
worldmap$region[worldmap$region == 'Virgin Islands'][1:23] <- "British Virgin Islands"
worldmap$region[worldmap$region == 'Virgin Islands'] <- "United States Virgin Islands"
# Get list of countries
countrylist <- unique(worldmap$region)
# Load access data
access_data <- read.csv('access_data.csv', header=TRUE, stringsAsFactors = F, na.strings="NA")
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_blank()
)
for(h in 1990:2014){
# Get access data for year h
access_df <- access_data[access_data$Year == as.numeric(h),]
access_df <- cbind.data.frame(access_df$country, as.numeric(access_df$Nat.Elec.Rate), stringsAsFactors=FALSE)
names(access_df) <- c("Country","Nat.Elec.Rate")
# Replace electrification rates over 80% with NA
# access_df$Nat.Elec.Rate[access_df$Nat.Elec.Rate >= 60] <- NA
# Merge access data with map.world by country
df <- merge(map.world, access_df, by.x = "region", by.y = "Country", sort = F, all.x=T)
df2 <- df[order(df$order),]
# Append column to map data and rename
map.world2 <- cbind.data.frame(map.world, as.numeric(df2$Nat.Elec.Rate), stringsAsFactors=FALSE)
# Rename column
column <- paste0(h,"_Access")
names(map.world2)[names(map.world2) == "as.numeric(df2$Nat.Elec.Rate)"] <- "access"
# Plot
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(data=map.world2, map=map.world2, aes(x=long, y=lat, map_id=region, fill=access)) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text", x = 160, y = 66.5,
label = "\U00A9 K. Ramirez-Meyers", col="white", cex=1,
alpha = 0.8)
gg
# Save plot
ggsave(paste0(column,"-max100.jpg"), dpi = 72)
names(map.world2)[ncol(map.world2)] <- column
}
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h)
# Plot
gg = ggplot() +
ggtitle(as.character(h), cex=4) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
ggsave(paste0(column,"-max100.jpg"), dpi = 72)
}
YearMapDataFxn = function(h){
# Get access data for year h
access_df <- access_data[access_data$Year == as.numeric(h),]
access_df <- cbind.data.frame(access_df$country, as.numeric(access_df$Nat.Elec.Rate), stringsAsFactors=FALSE)
names(access_df) <- c("Country","Nat.Elec.Rate")
# Replace electrification rates over 80% with NA
# access_df$Nat.Elec.Rate[access_df$Nat.Elec.Rate >= 60] <- NA
# Merge access data with map.world by country
df <- merge(worldmap, access_df, by.x = "region", by.y = "Country", sort = F, all.x=T)
df2 <- df[order(df$order),]
# Append column to map data and rename
worldmap2 <- cbind.data.frame(worldmap, as.numeric(df2$Nat.Elec.Rate), stringsAsFactors=FALSE)
names(worldmap2)[names(worldmap2) == "as.numeric(df2$Nat.Elec.Rate)"] <- "access"
return(worldmap2)
}
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h)
# Plot
gg = ggplot() +
ggtitle(as.character(h), cex=4) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
ggsave(paste0(column,"-max100.jpg"), dpi = 72)
}
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h)
# Plot
gg = ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5, cex=4)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
ggsave(paste0(column,"-max100.jpg"), dpi = 72)
}
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h)
# Plot
gg = ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
ggsave(paste0(column,"-max100.jpg"), dpi = 72)
}
View(worldmap2)
h=1990
worldmap2 <- YearMapDataFxn(h)
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
ggsave(paste0(column,"-max100.jpg"), dpi = 72)
column <- paste0(h,"_Access")
ggsave(paste0(column,"-max100.jpg"), dpi = 72)
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h)
# Plot
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
column <- paste0(h,"_Access")
ggsave(paste0(column,"-max100.jpg"), dpi = 72)
}
image_read('/Maps-max100/gif100.gif') %>% image_animate()
library(magick)
image_read('/Maps-max100/gif100.gif') %>% image_animate()
image_read('Maps-max100/gif100.gif') %>% image_animate()
setwd("~/GoogleDrive/1UT/1Courses/1Spring18/DATA/Project/1GTFdata/ME397_Sp18_FinalProject/Maps-max80")
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h,MaxPerc=80)
# Plot
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
column <- paste0(h,"_Access")
ggsave(paste0(column,"-max",MaxPerc,".jpg"), dpi = 72)
}
YearMapDataFxn = function(h,MaxPerc=100){
# Get access data for year h
access_df <- access_data[access_data$Year == as.numeric(h),]
access_df <- cbind.data.frame(access_df$country, as.numeric(access_df$Nat.Elec.Rate), stringsAsFactors=FALSE)
names(access_df) <- c("Country","Nat.Elec.Rate")
# Replace electrification rates over 80% with NA
access_df$Nat.Elec.Rate[access_df$Nat.Elec.Rate >= MaxPerc] <- NA
# Merge access data with map.world by country
df <- merge(worldmap, access_df, by.x = "region", by.y = "Country", sort = F, all.x=T)
df2 <- df[order(df$order),]
# Append column to map data and rename
worldmap2 <- cbind.data.frame(worldmap, as.numeric(df2$Nat.Elec.Rate), stringsAsFactors=FALSE)
names(worldmap2)[names(worldmap2) == "as.numeric(df2$Nat.Elec.Rate)"] <- "access"
return(worldmap2)
}
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h,MaxPerc=80)
# Plot
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
column <- paste0(h,"_Access")
ggsave(paste0(column,"-max",MaxPerc,".jpg"), dpi = 72)
}
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h,80)
# Plot
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
column <- paste0(h,"_Access")
ggsave(paste0(column,"-max80.jpg"), dpi = 72)
}
setwd("~/GoogleDrive/1UT/1Courses/1Spring18/DATA/Project/1GTFdata/ME397_Sp18_FinalProject")
runApp()
library(shiny)
library(shinydashboard)
library(ggplot2)
library(ggmap)
library(maps)
# Load world map and fix virgin islands labels
worldmap <- map_data(map="world")
worldmap$region[worldmap$region == 'Virgin Islands'][1:23] <- "British Virgin Islands"
worldmap$region[worldmap$region == 'Virgin Islands'] <- "United States Virgin Islands"
# Get list of countries
countrylist <- unique(worldmap$region)
# Load access data
access_data <- read.csv('access_data.csv', header=TRUE, stringsAsFactors = F, na.strings="NA")
# Define data processing function with year, h, as input
YearMapDataFxn = function(h,MaxPerc=100){
# Get access data for year h
access_df <- access_data[access_data$Year == as.numeric(h),]
access_df <- cbind.data.frame(access_df$country, as.numeric(access_df$Nat.Elec.Rate), stringsAsFactors=FALSE)
names(access_df) <- c("Country","Nat.Elec.Rate")
# Replace electrification rates over 80% with NA
access_df$Nat.Elec.Rate[access_df$Nat.Elec.Rate >= MaxPerc] <- NA
# Merge access data with map.world by country
df <- merge(worldmap, access_df, by.x = "region", by.y = "Country", sort = F, all.x=T)
df2 <- df[order(df$order),]
# Append column to map data and rename
worldmap2 <- cbind.data.frame(worldmap, as.numeric(df2$Nat.Elec.Rate), stringsAsFactors=FALSE)
names(worldmap2)[names(worldmap2) == "as.numeric(df2$Nat.Elec.Rate)"] <- "access"
return(worldmap2)
}
runApp()
setwd("~/GoogleDrive/1UT/1Courses/1Spring18/DATA/Project/1GTFdata/ME397_Sp18_FinalProject/Maps-max50")
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h,50)
# Plot
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
column <- paste0(h,"_Access")
ggsave(paste0(column,"-max50.jpg"), dpi = 72)
}
setwd("~/GoogleDrive/1UT/1Courses/1Spring18/DATA/Project/1GTFdata/ME397_Sp18_FinalProject/Maps-max100")
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h)
# Plot
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
column <- paste0(h,"_Access")
ggsave(paste0(column,"-max100.jpg"), dpi = 72)
}
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5, size = 30)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h)
# Plot
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5, size = 30)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
column <- paste0(h,"_Access")
ggsave(paste0(column,"-max100.jpg"), dpi = 72)
}
setwd("~/GoogleDrive/1UT/1Courses/1Spring18/DATA/Project/1GTFdata/ME397_Sp18_FinalProject/Maps-max50")
for(h in 1990:2014){
worldmap2 <- YearMapDataFxn(h,50)
# Plot
gg <- ggplot() +
ggtitle(as.character(h)) +
theme(plot.title = element_text(hjust = 0.5, size = 30)) +
geom_map(
data=worldmap2,
map=worldmap2,
aes(x=long, y=lat, map_id=region, fill=access)
) +
scale_fill_gradient(low = "orange", high = "blue", guide = "colourbar") +
coord_equal() +
ditch_the_axes +
annotate("text",x=160, y=66.5,label = "\U00A9 K. Ramirez-Meyers",col="white", cex=2,alpha = 0.8)
gg
column <- paste0(h,"_Access")
ggsave(paste0(column,"-max50.jpg"), dpi = 72)
}
setwd("~/GoogleDrive/1UT/1Courses/1Spring18/DATA/Project/1GTFdata/ME397_Sp18_FinalProject")
runApp()
runApp()
runApp()
runApp()
runApp()
